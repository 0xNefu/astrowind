---
// src/components/blog/GridItem.astro
// 100% BULLETPROOF FINAL VERSION – WORKS NO MATTER WHAT
import type { Post } from '~/types';
import { getPermalink } from '~/utils/permalinks';

export interface Props {
  post: Post;
}

const { post } = Astro.props;

// SUPER SAFE FALLBACKS – this kills ALL "undefined" errors forever
const title = post.data?.title || post.title || 'Untitled';
const excerpt = post.data?.excerpt || post.excerpt || '';
const image = post.data?.image || post.image;
const width = post.data?.width || 1600;
const height = post.data?.height || 896;

const link = post.slug ? getPermalink(post.slug, 'post') : '#';
---

<article class="mb-10 group">
  {image && (
    <a href={link} class="block mb-4 overflow-hidden rounded-xl shadow-xl">
      <img
        src={image}
        alt={title}
        width={width}
        height={height}
        loading="lazy"
        class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-500"
      />
    </a>
  )}

  <h3 class="text-2xl font-bold mb-3">
    <a href={link} class="hover:text-cyan-400 transition">
      {title}
    </a>
  </h3>

  <p class="text-muted dark:text-slate-400 leading-relaxed">
    {excerpt}
  </p>
</article>