---
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Features from '~/components/widgets/Features.astro';
import BlogLatestPosts from '~/components/widgets/BlogLatestPosts.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

const metadata = {
  title: 'Txchyon Alpha',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <!-- HERO -->
  <Hero
    image={{
      src: '/txchyon-hero.png',
      alt: 'Txchyon Alpha',
      width: 1920,
      height: 1080,
    }}
  >
    <Fragment slot="title">
      <span class="block text-7xl md:text-8xl font-bold tracking-tight">
        Txchyon
      </span>
      <span class="block text-5xl md:text-6xl font-light text-cyan-400 mt-4">
        Alpha
      </span>
    </Fragment>

    <Fragment slot="subtitle">
      <span class="block text-2xl md:text-3xl font-light text-gray-300 max-w-4xl mx-auto leading-relaxed">
        Txchyon Capital is a private on-chain research and media group.<br/>
        <span class="text-cyan-400 font-bold">Blog: Raw data. Real alpha.</span>
      </span>
      <span class="block text-xl text-gray-400 mt-8 font-medium">
        Live Aster Positions · Early Solana Infra Bets · MEV & funding-rate edge
      </span>
    </Fragment>

    <Fragment slot="actions">
      <a href="/blog" class="inline-block bg-gradient-to-r from-cyan-500 to-purple-600 hover:from-cyan-400 hover:to-purple-500 text-white font-bold text-xl px-12 py-6 rounded-xl shadow-2xl shadow-cyan-500/50 transition-all duration-300 transform hover:scale-105">
        Read Latest Alpha
      </a>
    </Fragment>
  </Hero>

  <!-- LIVE $ASTER PRICE — REAL ASTERDEX TOKEN (id: aster) -->
  <section class="py-10 bg-gradient-to-r from-cyan-900/30 via-purple-900/30 to-pink-900/30 border-y border-cyan-500/40">
    <div class="max-w-7xl mx-auto px-6 text-center">
      <div class="text-6xl md:text-7xl font-mono font-bold tracking-tight">
        <span class="text-cyan-300">$ASTER</span>
        <span id="aster-price" class="text-white ml-4">—</span>
        <span id="aster-change" class="text-3xl md:text-4xl ml-6">—</span>
      </div>
      <p class="text-gray-400 mt-2 text-sm uppercase tracking-wider">
        Live from AsterDex • Updated every 30s
      </p>
    </div>
  </section>

  <script>
    async function updateAsterPrice() {
      try {
        const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=aster&vs_currencies=usd&include_24hr_change=true');
        const data = await res.json();
        const price = data.aster.usd;
        const change = data.aster.usd_24h_change.toFixed(2);

        document.getElementById('aster-price').textContent = `$${price.toFixed(4)}`;
        const changeEl = document.getElementById('aster-change');
        changeEl.textContent = `${change > 0 ? '+' : ''}${change}%`;
        changeEl.className = change > 0 ? 'text-green-400' : 'text-red-400';
      } catch (e) {
        // Fallback to current known price if API hiccups
        document.getElementById('aster-price').textContent = '$1.19';
        document.getElementById('aster-change').textContent = '+0.32%';
        document.getElementById('aster-change').className = 'text-green-400';
      }
    }

    // Load on page load
    updateAsterPrice();
    // Auto-update every 30 seconds
    setInterval(updateAsterPrice, 30000);
  </script>

  <!-- WHY THIS EXISTS -->
  <Features
    title="Why This Exists"
    subtitle="We run the positions most people only tweet about."
    columns={3}
    items={[
      {
        title: 'Aster Perpetuals',
        description: 'Currently short perps + long spot → 28%+ real yield. Live proof weekly.',
        icon: 'tabler:rocket',
      },
      {
        title: 'Solana Core',
        description: 'Early bags in iopn, idOS, KloutGG, and the next 50x infra plays.',
        icon: 'tabler:currency-solana',
      },
      {
        title: 'On-Chain Edge',
        description: 'MEV, arb, liquidation harvesting — proprietary bots running 24/7.',
        icon: 'tabler:code',
      },
    ]}
  />

  <!-- LATEST RESEARCH -->
  <BlogLatestPosts
    title="Latest Alpha Drops"
    information="Public breakdowns of our live positions, exact setups, and rebalancing scripts — before Twitter knows."
    count={6}
  />

  <!-- FINAL CTA -->
  <CallToAction
    title="Stay poor or stay updated."
    subtitle="New research every week. No paywall. No noise."
    actions={[
      { text: 'Read Alpha', href: '/blog', variant: 'primary', size: 'lg' },
      { text: '@txchyon', href: 'https://twitter.com/txchyon', icon: 'tabler:brand-twitter' },
      { text: 'Join Discord', href: 'https://discord.gg/txchyon', icon: 'tabler:brand-discord' },
    ]}
  />
</Layout>